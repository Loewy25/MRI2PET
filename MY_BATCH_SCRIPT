#!/bin/bash

#SBATCH --job-name=patch5
#SBATCH --mem=10G
#SBATCH -t 15:50:00
#SBATCH --gres=gpu:tesla_a100:1
#SBATCH --partition=tier1_gpu
#SBATCH --account=shinjini_kundu

##SBATCH --exclude=gpua408,gpua401,gpu07,gpu09
#SBATCH --output=slurm-%A_haha.out
#SBATCH --error=slurm-%A_haha.err

module load cuda/12.9
module load cudnn/9.11.0.98-cuda12


 . ~/miniconda3/bin/activate
conda activate pasta

pip install wandb

export WANDB_API_KEY="b8c85c848af247ca775dabc571ae0012a4c36877"
# wandb login 可以省略交互式那句，或者用: wandb login $WANDB_API_KEY

# ---- NEW: per-job config ----
export RUN_NAME="uptake_kernel3_skip_spatial_nohierachy_fold2_os4_aug_3"
export FOLD_INDEX=1

# Oversampling (train only)
export OVERSAMPLE_ENABLE=1
export OVERSAMPLE_LABEL3_TARGET=0.4

# Augmentation (train only)
export AUG_ENABLE=1
export AUG_PROB=0.3
export AUG_FLIP_PROB=0.5
export AUG_INTENSITY_PROB=0.8
export AUG_NOISE_STD=0.03
export AUG_SCALE_MIN=0.9
export AUG_SCALE_MAX=1.1
export AUG_SHIFT_MIN=-0.05
export AUG_SHIFT_MAX=0.05

# High-uptake ROI loss (inside cortex mask)
export ROI_HI_Q=0.85
export ROI_HI_LAMBDA=2.5
export ROI_HI_MIN_VOXELS=32

python main.py




